Note: please do not use any functions which are not taught in the class. you need
  to solve the questions only with the concepts that have been discussed so far.


  CREATE TABLE [dbo].[returns](
	[order_id] [nvarchar](255) NULL,
	[return_reason] [nvarchar](255) NULL
) 

insert into returns values ('CA-2020-104689','Wrong Items');
insert into returns values ('CA-2020-105081','Wrong Items');
insert into returns values ('CA-2020-105291','Wrong Items');
insert into returns values ('CA-2020-105585','Wrong Items');
insert into returns values ('CA-2020-106950','Wrong Items');
insert into returns values ('CA-2020-109806','Wrong Items');
insert into returns values ('CA-2020-109869','Wrong Items');
insert into returns values ('CA-2020-111682','Wrong Items');
insert into returns values ('CA-2020-112123','Wrong Items');
insert into returns values ('CA-2020-112340','Wrong Items');
insert into returns values ('CA-2020-113341','Wrong Items');
insert into returns values ('CA-2020-114307','Wrong Items');
insert into returns values ('CA-2020-114727','Wrong Items');
insert into returns values ('CA-2020-115917','Wrong Items');
insert into returns values ('CA-2020-116547','Wrong Items');
insert into returns values ('CA-2020-116736','Wrong Items');
insert into returns values ('CA-2020-118311','Wrong Items');
insert into returns values ('CA-2020-118500','Wrong Items');
insert into returns values ('CA-2020-118899','Wrong Items');
insert into returns values ('CA-2020-120873','Wrong Items');
insert into returns values ('CA-2020-123526','Wrong Items');
insert into returns values ('CA-2020-124527','Wrong Items');
insert into returns values ('CA-2020-126529','Wrong Items');
insert into returns values ('CA-2020-126732','Wrong Items');
insert into returns values ('CA-2020-128671','Wrong Items');
insert into returns values ('CA-2020-130477','Wrong Items');
insert into returns values ('CA-2020-130638','Wrong Items');
insert into returns values ('CA-2020-130680','Wrong Items');
insert into returns values ('CA-2020-133319','Wrong Items');
insert into returns values ('CA-2020-133368','Wrong Items');
insert into returns values ('CA-2020-133802','Wrong Items');
insert into returns values ('CA-2020-134775','Wrong Items');
insert into returns values ('CA-2020-134803','Wrong Items');
insert into returns values ('CA-2020-136483','Wrong Items');
insert into returns values ('CA-2020-136924','Wrong Items');
insert into returns values ('CA-2020-138282','Wrong Items');
insert into returns values ('CA-2020-139269','Wrong Items');
insert into returns values ('CA-2020-142398','Wrong Items');
insert into returns values ('CA-2020-145261','Wrong Items');
insert into returns values ('CA-2020-145492','Wrong Items');
insert into returns values ('CA-2020-145583','Wrong Items');
insert into returns values ('CA-2020-145919','Wrong Items');
insert into returns values ('CA-2020-145982','Wrong Items');
insert into returns values ('CA-2020-147375','Wrong Items');
insert into returns values ('CA-2020-148796','Wrong Items');
insert into returns values ('CA-2020-150077','Wrong Items');
insert into returns values ('CA-2020-151323','Wrong Items');
insert into returns values ('CA-2020-151372','Wrong Items');
insert into returns values ('CA-2020-152814','Wrong Items');
insert into returns values ('CA-2020-157280','Wrong Items');
insert into returns values ('CA-2020-159023','Wrong Items');
insert into returns values ('CA-2020-159212','Wrong Items');
insert into returns values ('CA-2020-159345','Wrong Items');
insert into returns values ('CA-2020-161746','Wrong Items');
insert into returns values ('CA-2020-162138','Wrong Items');
insert into returns values ('CA-2020-162159','Wrong Items');
insert into returns values ('CA-2020-165330','Wrong Items');
insert into returns values ('CA-2020-166275','Wrong Items');
insert into returns values ('CA-2020-167759','Wrong Items');
insert into returns values ('CA-2020-168921','Wrong Items');
insert into returns values ('CA-2021-100111','Wrong Items');
insert into returns values ('CA-2021-101273','Wrong Items');
insert into returns values ('CA-2021-101574','Wrong Items');
insert into returns values ('CA-2021-101700','Wrong Items');
insert into returns values ('CA-2021-101805','Wrong Items');
insert into returns values ('CA-2021-102519','Wrong Items');
insert into returns values ('CA-2021-103380','Wrong Items');
insert into returns values ('CA-2021-107825','Wrong Items');
insert into returns values ('CA-2021-108294','Wrong Items');
insert into returns values ('CA-2021-108931','Wrong Items');
insert into returns values ('CA-2021-109085','Wrong Items');
insert into returns values ('CA-2021-111556','Wrong Items');
insert into returns values ('CA-2021-112725','Wrong Items');
insert into returns values ('CA-2021-112753','Wrong Items');
insert into returns values ('CA-2021-112865','Wrong Items');
insert into returns values ('CA-2021-113670','Wrong Items');
insert into returns values ('CA-2021-115427','Wrong Items');
insert into returns values ('CA-2021-115994','Wrong Items');
insert into returns values ('CA-2021-117212','Wrong Items');
insert into returns values ('CA-2021-117513','Wrong Items');
insert into returns values ('CA-2021-117926','Wrong Items');
insert into returns values ('CA-2021-118122','Wrong Items');
insert into returns values ('CA-2021-118542','Wrong Items');
insert into returns values ('CA-2021-119284','Wrong Items');
insert into returns values ('CA-2021-121258','Wrong Items');
insert into returns values ('CA-2021-121853','Wrong Items');
insert into returns values ('CA-2021-122007','Wrong Items');
insert into returns values ('CA-2021-122504','Wrong Items');
insert into returns values ('CA-2021-123085','Wrong Items');
insert into returns values ('CA-2021-123491','Wrong Items');
insert into returns values ('CA-2021-124401','Wrong Items');
insert into returns values ('CA-2021-127306','Wrong Items');
insert into returns values ('CA-2021-128965','Wrong Items');
insert into returns values ('CA-2021-129707','Wrong Items');
insert into returns values ('CA-2021-130631','Wrong Items');
insert into returns values ('CA-2021-131492','Wrong Items');
insert into returns values ('CA-2021-131618','Wrong Items');
insert into returns values ('CA-2021-131807','Wrong Items');
insert into returns values ('CA-2021-131828','Wrong Items');
insert into returns values ('CA-2021-132346','Wrong Items');
insert into returns values ('CA-2018-100762','Bad Quality');
insert into returns values ('CA-2018-100867','Bad Quality');
insert into returns values ('CA-2018-102652','Bad Quality');
insert into returns values ('CA-2018-103373','Bad Quality');
insert into returns values ('CA-2018-103744','Bad Quality');
insert into returns values ('CA-2018-103940','Bad Quality');
insert into returns values ('CA-2018-104829','Bad Quality');
insert into returns values ('CA-2018-105270','Bad Quality');
insert into returns values ('CA-2018-108609','Bad Quality');
insert into returns values ('CA-2018-108861','Bad Quality');
insert into returns values ('CA-2018-109918','Bad Quality');
insert into returns values ('CA-2018-110786','Bad Quality');
insert into returns values ('CA-2018-111871','Bad Quality');
insert into returns values ('CA-2018-116785','Bad Quality');
insert into returns values ('CA-2018-123225','Bad Quality');
insert into returns values ('CA-2018-123253','Bad Quality');
insert into returns values ('CA-2018-123498','Bad Quality');
insert into returns values ('CA-2018-124688','Bad Quality');
insert into returns values ('CA-2018-126361','Bad Quality');
insert into returns values ('CA-2018-126403','Bad Quality');
insert into returns values ('CA-2018-126522','Bad Quality');
insert into returns values ('CA-2018-127012','Bad Quality');
insert into returns values ('CA-2018-127131','Bad Quality');
insert into returns values ('CA-2018-133690','Bad Quality');
insert into returns values ('CA-2018-134726','Bad Quality');
insert into returns values ('CA-2018-135657','Bad Quality');
insert into returns values ('CA-2018-135699','Bad Quality');
insert into returns values ('CA-2018-140816','Bad Quality');
insert into returns values ('CA-2018-141726','Bad Quality');
insert into returns values ('CA-2018-142769','Bad Quality');
insert into returns values ('CA-2018-143336','Bad Quality');
insert into returns values ('CA-2018-143840','Bad Quality');
insert into returns values ('CA-2018-148614','Bad Quality');
insert into returns values ('CA-2018-148950','Bad Quality');
insert into returns values ('CA-2018-151162','Bad Quality');
insert into returns values ('CA-2018-152345','Bad Quality');
insert into returns values ('CA-2018-153150','Bad Quality');
insert into returns values ('CA-2018-156349','Bad Quality');
insert into returns values ('CA-2018-157924','Others');
insert into returns values ('CA-2018-159338','Others');
insert into returns values ('CA-2018-160766','Others');
insert into returns values ('CA-2018-160773','Others');
insert into returns values ('CA-2018-164721','Others');
insert into returns values ('CA-2018-164861','Bad Quality');
insert into returns values ('CA-2018-166744','Bad Quality');
insert into returns values ('CA-2018-169019','Bad Quality');
insert into returns values ('CA-2019-101910','Bad Quality');
insert into returns values ('CA-2019-103716','Bad Quality');
insert into returns values ('CA-2019-104129','Bad Quality');
insert into returns values ('CA-2019-105158','Bad Quality');
insert into returns values ('CA-2019-107678','Bad Quality');
insert into returns values ('CA-2019-109736','Bad Quality');
insert into returns values ('CA-2019-110814','Bad Quality');
insert into returns values ('CA-2019-111948','Bad Quality');
insert into returns values ('CA-2019-112144','Bad Quality');
insert into returns values ('CA-2019-113628','Bad Quality');
insert into returns values ('CA-2019-114048','Bad Quality');
insert into returns values ('CA-2019-116092','Bad Quality');
insert into returns values ('CA-2019-119214','Bad Quality');
insert into returns values ('CA-2019-119907','Bad Quality');
insert into returns values ('CA-2019-123568','Bad Quality');
insert into returns values ('CA-2019-124058','Bad Quality');
insert into returns values ('CA-2019-130456','Bad Quality');
insert into returns values ('CA-2019-130785','Wrong Items');
insert into returns values ('CA-2019-132374','Wrong Items');
insert into returns values ('CA-2019-132941','Wrong Items');
insert into returns values ('CA-2019-134075','Wrong Items');
insert into returns values ('CA-2019-134201','Wrong Items');
insert into returns values ('CA-2019-135580','Wrong Items');
insert into returns values ('CA-2019-138674','Wrong Items');
insert into returns values ('CA-2019-139731','Wrong Items');
insert into returns values ('CA-2019-140984','Wrong Items');
insert into returns values ('CA-2019-141593','Wrong Items');
insert into returns values ('CA-2019-142601','Wrong Items');
insert into returns values ('CA-2019-143238','Wrong Items');
insert into returns values ('CA-2019-143490','Wrong Items');
insert into returns values ('CA-2019-143602','Wrong Items');
insert into returns values ('CA-2019-144267','Wrong Items');
insert into returns values ('CA-2019-146255','Wrong Items');
insert into returns values ('CA-2019-146262','Wrong Items');
insert into returns values ('CA-2019-146486','Wrong Items');
insert into returns values ('CA-2019-148873','Wrong Items');
insert into returns values ('CA-2019-149342','Wrong Items');
insert into returns values ('CA-2019-149636','Wrong Items');
insert into returns values ('CA-2019-149650','Wrong Items');
insert into returns values ('CA-2019-150770','Wrong Items');
insert into returns values ('CA-2019-150875','Wrong Items');
insert into returns values ('CA-2019-151547','Wrong Items');
insert into returns values ('CA-2019-153220','Wrong Items');
insert into returns values ('CA-2019-154970','Wrong Items');
insert into returns values ('CA-2019-155761','Wrong Items');
insert into returns values ('CA-2019-156440','Wrong Items');
insert into returns values ('CA-2019-157770','Wrong Items');
insert into returns values ('CA-2019-157812','Wrong Items');
insert into returns values ('CA-2019-161627','Wrong Items');
insert into returns values ('CA-2019-162166','Wrong Items');
insert into returns values ('CA-2019-164882','Wrong Items');
insert into returns values ('CA-2019-168480','Wrong Items');
insert into returns values ('CA-2019-168564','Wrong Items');
insert into returns values ('CA-2019-169397','Wrong Items');
insert into returns values ('CA-2021-134194','Wrong Items');
insert into returns values ('CA-2021-135692','Wrong Items');
insert into returns values ('CA-2021-136308','Wrong Items');
insert into returns values ('CA-2021-136539','Wrong Items');
insert into returns values ('CA-2021-136651','Wrong Items');
insert into returns values ('CA-2021-137085','Wrong Items');
insert into returns values ('CA-2021-137099','Wrong Items');
insert into returns values ('CA-2021-137414','Wrong Items');
insert into returns values ('CA-2021-137428','Wrong Items');
insert into returns values ('CA-2021-138163','Wrong Items');
insert into returns values ('CA-2021-140053','Wrong Items');
insert into returns values ('CA-2021-140151','Wrong Items');
insert into returns values ('CA-2021-140186','Wrong Items');
insert into returns values ('CA-2021-140585','Wrong Items');
insert into returns values ('CA-2021-140963','Wrong Items');
insert into returns values ('CA-2021-141929','Wrong Items');
insert into returns values ('CA-2021-142328','Wrong Items');
insert into returns values ('CA-2021-142342','Wrong Items');
insert into returns values ('CA-2021-142867','Wrong Items');
insert into returns values ('CA-2021-142888','Wrong Items');
insert into returns values ('CA-2021-143084','Wrong Items');
insert into returns values ('CA-2021-144064','Wrong Items');
insert into returns values ('CA-2021-145128','Wrong Items');
insert into returns values ('CA-2021-145772','Wrong Items');
insert into returns values ('CA-2021-147452','Wrong Items');
insert into returns values ('CA-2021-150609','Wrong Items');
insert into returns values ('CA-2021-150910','Wrong Items');
insert into returns values ('CA-2021-152660','Wrong Items');
insert into returns values ('CA-2021-153822','Wrong Items');
insert into returns values ('CA-2021-154074','Wrong Items');
insert into returns values ('CA-2021-154214','Wrong Items');
insert into returns values ('CA-2021-154949','Wrong Items');
insert into returns values ('CA-2021-155712','Wrong Items');
insert into returns values ('CA-2021-156391','Wrong Items');
insert into returns values ('CA-2021-156958','Wrong Items');
insert into returns values ('CA-2021-157196','Wrong Items');
insert into returns values ('CA-2021-158729','Wrong Items');
insert into returns values ('CA-2021-159954','Wrong Items');
insert into returns values ('CA-2021-161459','Wrong Items');
insert into returns values ('CA-2021-161557','Wrong Items');
insert into returns values ('CA-2021-161956','Wrong Items');
insert into returns values ('CA-2021-162015','Wrong Items');
insert into returns values ('CA-2021-165008','Wrong Items');
insert into returns values ('CA-2021-165491','Wrong Items');
insert into returns values ('CA-2021-166093','Wrong Items');
insert into returns values ('CA-2021-166142','Wrong Items');
insert into returns values ('CA-2021-166898','Wrong Items');
insert into returns values ('CA-2021-167003','Wrong Items');
insert into returns values ('CA-2021-167395','Wrong Items');
insert into returns values ('CA-2021-168193','Wrong Items');
insert into returns values ('CA-2021-169327','Wrong Items');
insert into returns values ('CA-2021-169859','Wrong Items');
insert into returns values ('CA-2021-169894','Wrong Items');
insert into returns values ('US-2018-105137','Wrong Items');
insert into returns values ('US-2018-138758','Wrong Items');
insert into returns values ('US-2018-140452','Wrong Items');
insert into returns values ('US-2018-143287','Wrong Items');
insert into returns values ('US-2018-150574','Wrong Items');
insert into returns values ('US-2018-164406','Wrong Items');
insert into returns values ('US-2018-164763','Wrong Items');
insert into returns values ('US-2019-110569','Wrong Items');
insert into returns values ('US-2019-126214','Wrong Items');
insert into returns values ('US-2019-128090','Wrong Items');
insert into returns values ('US-2019-136749','Wrong Items');
insert into returns values ('US-2019-136987','Wrong Items');
insert into returns values ('US-2019-137008','Wrong Items');
insert into returns values ('US-2019-160857','Wrong Items');
insert into returns values ('US-2020-105578','Wrong Items');
insert into returns values ('US-2020-108455','Wrong Items');
insert into returns values ('US-2020-111528','Wrong Items');
insert into returns values ('US-2020-114230','Wrong Items');
insert into returns values ('US-2020-114293','Wrong Items');
insert into returns values ('US-2020-115952','Wrong Items');
insert into returns values ('US-2020-119046','Wrong Items');
insert into returns values ('US-2020-127425','Wrong Items');
insert into returns values ('US-2020-131149','Wrong Items');
insert into returns values ('US-2020-135720','Wrong Items');
insert into returns values ('US-2020-140172','Wrong Items');
insert into returns values ('US-2020-144057','Wrong Items');
insert into returns values ('US-2020-148957','Wrong Items');
insert into returns values ('US-2020-151827','Wrong Items');
insert into returns values ('US-2020-152051','Wrong Items');
insert into returns values ('US-2020-156986','Wrong Items');
insert into returns values ('US-2020-157490','Wrong Items');
insert into returns values ('US-2021-103247','Wrong Items');
insert into returns values ('US-2021-103828','Wrong Items');
insert into returns values ('US-2021-105046','Wrong Items');
insert into returns values ('US-2021-107888','Wrong Items');
insert into returns values ('US-2021-109253','Wrong Items');
insert into returns values ('US-2021-118087','Wrong Items');
insert into returns values ('US-2021-123834','Others');
insert into returns values ('US-2021-136679','Others');
insert into returns values ('US-2021-147886','Others');
insert into returns values ('US-2021-147998','Wrong Items');
insert into returns values ('US-2021-151127','Wrong Items');
insert into returns values ('US-2021-155999','Wrong Items');

show databases;
SELECT * 
FROM information_schema.tables;

select * from returns;

create table employee(
    emp_id int,
    emp_name varchar(20),
    dept_id int,
    salary int,
    manager_id int,
    emp_age int
);


insert into employee values(1,'Ankit',100,10000,4,39);
insert into employee values(2,'Mohit',100,15000,5,48);
insert into employee values(3,'Vikas',100,10000,4,37);
insert into employee values(4,'Rohit',100,5000,2,16);
insert into employee values(5,'Mudit',200,12000,6,55);
insert into employee values(6,'Agam',200,12000,2,14);
insert into employee values(7,'Sanjay',200,9000,2,13);
insert into employee values(8,'Ashish',200,5000,2,12);
insert into employee values(9,'Mukesh',300,6000,6,51);
insert into employee values(10,'Rakesh',500,7000,6,50);
select * from employee;

create table dept(
    dep_id int,
    dep_name varchar(20)
);
insert into dept values(100,'Analytics');
insert into dept values(200,'IT');
insert into dept values(300,'HR');
insert into dept values(400,'Text Analytics');
select * from dept;

select * from employee;
select * from dept;

--1- write a query to get region wise count of return orders

select region,count(distinct (o.order_id)) from orders o inner join returns r on o.order_id=r.order_id
group by region


-- 2- write a query to get category wise sales of orders that were not returned
select sum(o.sales) as total_sales,category from orders o full outer join returns r on o.order_id=r.order_id
where r.return_reason is null group by category 


--3- write a query to print dept name and average salary of employees in that dep .
select d.dep_name ,avg(salary) from employee e left join dept d on e.dept_id=d.dep_id where
d.dep_name is not null group by d.dep_name


--4- write a query to print dep names where none of the emplyees have same salary.
select d.dep_name from employee e left join dept d on e.dept_id=d.dep_id 


select * from employee;
select * from dept;

--5- write a query to print sub categories where we have all 3 kinds of returns (others,bad quality,wrong items)
select o.sub_category from orders o full join returns r on 
o.order_id=r.order_id where return_reason  in ('others','bad quality','wrong items')
group by o.sub_category


select o.sub_category
from orders o
inner join returns r on o.order_id=r.order_id
group by o.sub_category
having count(distinct r.return_reason)=3

--6- write a query to find cities where not even a single order was returned.
select city from orders o
left join returns r on o.order_id=r.order_id
group by city
having count(r.order_id)=0



--7- write a query to find top 3 subcategories by sales of returned orders in east region
select top 3 sub_category,sum(o.sales) as return_sales from orders o inner join returns r on 
o.order_id=r.order_id where region ='East' group by sub_category order by return_sales desc




--8- write a query to print dep name for which there is no employee
select d.dep_name from employee e
 right join dept d on e.dept_id=d.dep_id
where e.emp_name is null


--9- write a query to print employees name where dep id is not avaiable in dept table
select e.* from employee e
 left join dept d on e.dept_id=d.dep_id
where d.dep_name is null



--10-write a query to print emp name , their manager name and diffrence in their age for employees whose age is less then their manager's age 
  select e.emp_name,m.emp_name as manager_name ,m.emp_age-e.emp_age as age_diff
  from employee e inner join employee m on e.manager_id=m.emp_id 
  where e.emp_age < m.emp_age; 
 
  
select * from employee

--11-write a query to print emp name, manager name and senior manager name (senior manager is manager's manager)
  select e.emp_name,m.emp_name as manager_name,s.emp_name as senior_manager
  from employee e 
  inner join employee m on e.manager_id=m.emp_id  
  inner join employee s on m.manager_id=s.emp_id






